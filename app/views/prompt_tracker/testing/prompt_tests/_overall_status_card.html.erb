<div class="card metric-card" id="overall_status_card">
  <div class="metric-value">
    <%
      enabled_tests = tests.select(&:enabled?)
      tests_with_runs = enabled_tests.select { |t| t.last_run.present? }

      if tests_with_runs.empty?
        status = :not_run
        badge_class = "bg-secondary"
        icon = "â—‹"
        text = "Not Run"
      elsif tests_with_runs.any? { |t| t.last_run.status == 'running' }
        status = :running
        badge_class = "bg-warning"
        icon = '<span class="spinner-border spinner-border-sm me-1"></span>'.html_safe
        text = "Running"
      elsif tests_with_runs.any? { |t| !t.passing? }
        status = :failing
        badge_class = "bg-danger"
        icon = "âœ—"
        text = "Failing"
      else
        status = :passing
        badge_class = "bg-success"
        icon = "âœ“"
        text = "Passing"
      end
    %>
    <span class="badge <%= badge_class %>"><%= icon %> <%= text %></span>
  </div>
  <div class="metric-label">
    Test Suite Status
    <i class="bi bi-info-circle text-muted"
       data-bs-toggle="tooltip"
       data-bs-placement="top"
       title="Overall status: Failing if any test fails, Passing if all tests pass, Running if any test is running"
       style="cursor: help;"></i>
  </div>
</div>
