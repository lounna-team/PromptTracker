<div class="card mb-4">
  <div class="card-header bg-light">
    <h5 class="mb-0" style="color: #374151;">
      <i class="bi bi-regex"></i>
      Pattern Match Evaluation
    </h5>
  </div>
  <div class="card-body">
    <% config = evaluation.metadata['config'] || {} %>
    <%
      # Handle both string (newline-separated) and array formats
      raw_patterns = config['patterns'] || config[:patterns] || []
      patterns = raw_patterns.is_a?(String) ? raw_patterns.split("\n").map(&:strip).reject(&:blank?) : Array(raw_patterns)
    %>
    <% match_all = config['match_all'] || config[:match_all] %>

    <div class="alert alert-secondary mb-3">
      <strong>Match Mode:</strong>
      <% if match_all %>
        <span class="badge bg-primary">ALL patterns must match</span>
      <% else %>
        <span class="badge bg-info">ANY pattern must match</span>
      <% end %>
    </div>

    <% if patterns.any? %>
      <h6><i class="bi bi-list-check"></i> Patterns</h6>
      <ul class="list-group mb-3">
        <% patterns.each do |pattern| %>
          <li class="list-group-item">
            <code><%= pattern %></code>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="text-muted"><em>No patterns configured</em></p>
    <% end %>

    <% if evaluation.feedback.present? %>
      <div class="alert <%= evaluation.passed? ? 'alert-success' : 'alert-warning' %> mb-0">
        <strong>Result:</strong> <%= evaluation.feedback %>
      </div>
    <% end %>
  </div>
</div>
