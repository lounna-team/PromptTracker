<%# Configuration form for Format Evaluator %>

<div class="alert alert-info mb-3">
  <i class="bi bi-file-code"></i>
  <strong>Format Validator</strong>
  <p class="mb-0 mt-1">Validates response format (JSON, Markdown, etc.).</p>
</div>

<!-- Expected Format -->
<div class="mb-3">
  <label class="form-label">Expected Format</label>
  <select name="config[expected_format]" class="form-select" id="config_format_select" required>
    <option value="json">JSON</option>
    <option value="markdown">Markdown</option>
    <option value="plain">Plain Text</option>
    <option value="html">HTML</option>
    <option value="xml">XML</option>
  </select>
  <small class="form-text text-muted">
    The format that responses should conform to.
  </small>
</div>

<!-- Schema Validation (for JSON) -->
<div class="mb-3" id="config_schema_section">
  <label class="form-label">Schema Validation (Optional)</label>
  <textarea name="config[schema]"
            class="form-control font-monospace"
            rows="8"
            placeholder='{"required_keys": ["status", "data"], "types": {"status": "string"}}'></textarea>
  <small class="form-text text-muted">
    Define the expected JSON schema with required keys, optional keys, and types.
  </small>
</div>

<!-- Strict Mode -->
<div class="mb-3 form-check">
  <input type="checkbox"
         name="config[strict]"
         class="form-check-input"
         id="format_strict"
         value="true">
  <label class="form-check-label" for="format_strict">
    Strict validation
  </label>
  <div class="form-text">
    For JSON with schema: no extra keys allowed beyond required and optional keys.
  </div>
</div>

<script>
  // Show/hide schema validation based on format selection
  document.addEventListener('DOMContentLoaded', function() {
    const formatSelect = document.getElementById('config_format_select');
    const schemaSection = document.getElementById('config_schema_section');

    function toggleSchemaSection() {
      if (formatSelect && schemaSection) {
        if (formatSelect.value === 'json') {
          schemaSection.style.display = 'block';
        } else {
          schemaSection.style.display = 'none';
        }
      }
    }

    if (formatSelect) {
      formatSelect.addEventListener('change', toggleSchemaSection);
      toggleSchemaSection(); // Initial state
    }
  });
</script>

<div class="alert alert-secondary">
  <strong>Scoring:</strong>
  <ul class="mb-0 mt-2">
    <li>Valid format: <strong>100 points</strong></li>
    <li>Invalid format: <strong>0 points</strong></li>
    <li>Strict mode adds additional validation rules</li>
  </ul>
</div>

<div class="alert alert-warning">
  <i class="bi bi-info-circle"></i>
  <strong>Note:</strong> For JSON format, the response must be valid JSON. For Markdown, it checks for common Markdown syntax.
</div>
